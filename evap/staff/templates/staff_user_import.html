{% extends "staff_base.html" %}

{% load static %}
{% load bootstrap3 %}
{% load staff_templatetags %}

{% block content %}
    {{ block.super }}
    {% for error in errors %}
        <div class="alert alert-danger alert-dismissable">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&#215;</button>
            {{ error }}
        </div>
    {% endfor %}

    {% for key, warninglist in warnings.items %}
        {% if warninglist %}
            <div class="panel panel-default panel-warning">
                <div class="panel-heading">
                    <span class="panel-title" id="{{ key }}-q">
                        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#{{ key }}">{{ key|warningname }}</a>
                    </span>
                </div>
                <div id="{{ key }}" class="panel-collapse collapse in">
                    <div class="panel-body">
                        {% for warning in warninglist %}
                        <div class="alert alert-warning alert-dismissable">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&#215;</button>
                            {{ warning }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endif %}
    {% endfor %}

    <form id="user-import-form" method="POST" enctype="multipart/form-data" class="form-horizontal">
        <div class="panel panel-info">
            <div class="panel-heading"> User Import </div>
            <div class="panel-body">
                <p>
                {% trans "Upload user data from excel file (" %}<a href="{% get_static_prefix %}sample_user.xls">{% trans "Sample File"%}</a>{% trans "). This will create all containing users." %}
                </p>
                {% csrf_token %}
                {% bootstrap_form excel_form layout='horizontal' %}
            </div>
            <div class="panel-footer">
                {% if not test_passed %}
                <button name="operation" value="test" type="submit" class="btn btn-primary form-submit-btn">{% trans "Upload and Test" %}</button>
                {% else %}
                <button name="operation" value="test" type="submit" class="btn btn-default form-submit-btn">{% trans "Upload and Test" %}</button>
                <div class="form-submit-btn-divider"></div>
                <button name="operation" value="import" type="submit" class="btn btn-primary form-submit-btn">{% trans "Import previously uploaded file" %}</button>
                {% endif %}
            </div>
        </div>
    </form>
    {% endblock %}
